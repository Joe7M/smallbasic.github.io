<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SmallBASIC | UNIT</title>
  <meta name="description" content="Declares the source module as a unit. Units are a set of procedures, functions and/or variables that can be used by another program or unit.">
  <link rel="canonical" href="1446">
  <link rel="keywords" href="UNIT name">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="icon" type="image/png" href="/images/sb-desktop-32x32.png">
  <script src="/clipboard.js"></script>
</head>
  <body>
<div class="wrapAll clearfix">
  <div class="sidebar">
    <div class="logo">
      <a href="/"><img src='/images/sb-desktop-128x128.png' alt="logo"></a>
    </div>
    <div class="navigation">
      <h4>SmallBASIC</h4>
      <ul>
        <li><a href="/">Main page</a></li>
        <li><a href="/pages/download.html">Download</a></li>
        <li><a href="/pages/reference.html">Language reference</a></li>
        <li><a href="/pages/samples.html">Code library</a></li>
      </ul>
      <hr class="menuSeparator"/>
      <ul>
        <li><a href="/pages/articles.html">Articles</a></li>
        <li><a href="/pages/community.html">Community</a></li>
        <li><a href="/pages/changelog.html">Changelog</a></li>
        <li><a href="/pages/screenshots.html">Screenshots</a></li>
        <li><a href="/pages/links.html">Links</a></li>
      </ul>
    </div>
  </div>
  <div class="mainsection">
    <div class="tabs clearfix">
      <div class="tabsLeft">
        <ul>
          <li><a href="#" class="active">Article</a></li>
          <li><a href="https://www.syntaxbomb.com/smallbasic">Discuss</a></li>
        </ul>
      </div>
      <div id="simpleSearch">
        <form action="https://github.com/smallbasic/smallbasic.github.io/search"
              target="_github" accept-charset="UTF-8" method="get" style="display:inline">
          <div id="submitSearch">
            <button type="submit">&nbsp;</button>
            <input type="hidden" class="js-site-search-type-field" name="type">
            <input type="hidden" name="utf8" value="✓">
            <input type="hidden" name="l" value="Visual Basic">
            <input type="text" name="q" placeholder="Search" id="searchInput">
          </div>
        </form>
      </div>
      <div class="tabsRight">
        <ul>
          <li><a target="_github" href="https://github.com/smallbasic/smallbasic.github.io/blob/master/_build/reference/1446-system-unit.markdown">View source</a></li>
          <li><a target="_github" href="https://github.com/smallbasic/smallbasic.github.io/commits/master/_build/reference/1446-system-unit.markdown">View history</a></li>
        </ul>
      </div>
    </div>
<div class="article">
  <h1>UNIT</h1>
  <blockquote>UNIT name</blockquote>
  <div class="siteSub">
    <p>
      <a href="/">Home</a> &gt;
      <a href="/pages/reference.html">Reference</a> &gt;
      <a href="/pages/system.html">System</a>
    </p>
  </div>
</blockquote>
<p>Declares the source module as a unit. Units are a set of procedures, functions, constants or variables that can be used by another program or unit.</p>
<ul>
<li>UNIT supports ‘namespace’ (Namespaces allow reuse of same names in different contexts. e.g. BitLib.Set(x) and StrLib.Set(x) are both using a function with the same name, “Set”, but in different contexts).</li>
<li>While UNIT can be used as a collection of sub-routines for your own program, UNIT is particularly useful for creating a general-purpose library. General purpose libraries can be useful for many programs or projects, the same way the internal routine “PRINT” is useful for many programs, and not only for specific one.</li>
</ul>
<p>Use EXPORT to export procedured, functions, constants or variables. Only exported names can be access in the main program.</p>
<h3 id="example-1-simple-unit">Example 1: Simple Unit</h3>
<p>First an example of the unit. Please save it with the filename “MyTestUnit.bas”</p>
<pre><code>UNIT MyTestUnit

export MyFunc
export MySub
export MyConst = 3.1415
export MyVar = 5

func MyFunc(a,b)
    return a + b
end

sub MySub(a,b)
    print &quot;a + b = &quot;; a + b
end</code></pre>
<p>Second an example on how to use the unit.</p>
<pre><code>import MyTestUnit as u

u.MySub(1,2)

print u.MyFunc(2,3)
print u.MyConst

u.MyVar = u.MyVar + 5
print u.MyVar</code></pre>
<h3 id="example-2-an-unit-for-using-string">Example 2: An unit for using string</h3>
<p>The UNIT file is strlib.bas:</p>
<pre><code>
&#39; File: strlib.bas
&#39; ------------
&#39; In this demo we are using UNIT to add more useful String commands to
&#39; SmallBASIC, by carefully creating our own String-Library: strlib.bas
&#39;
&#39; This demo includes only two useful functions, Lset() and Rset(); You
&#39; can add more useful functions, subs, constants - but make sure that
&#39; they are all String commands (not Array, File, Data, etc).
&#39;
&#39; Write your code carefully and efficiently, because you will use these
&#39; commands frequently in other projects. And don&#39;t forget to debug the
&#39; code and to add clear documentation, for you and for others.
&#39;
&#39; See also Home--&gt;Article--&gt;Welcome to SmallBASIC--&gt;Units.
&#39; ------------
&#39;

&#39; Here we declare that this file is a UNIT file.
&#39; Note: Keep file-name and unit-name the same. That helps the SB to
&#39;       automatically recompile the required units when it is needed (i.e.
&#39;       to create strlib.sbu file).
&#39;       The actual file name must be in lower case for Linux OS.
Unit strlib &#39; (without .bas extension)
&#39; Here we allow other SmallBASIC files to use some of our library keywords:
Export Lset, Rset

&#39; Left justify string s in buffer of length b.
&#39; example: x = Lset(&quot; SmallBASIC &quot;, 15) &#39; --&gt; x is &quot; SmallBASIC    &quot;
Func Lset(s, b)
  Local l = Len(s)

  If l &gt;= b Then
    Lset = Left(s, b)
  Else
    Lset = s + Space(b - l)
  Fi
End
&#39; Right justify string s in buffer of length b.
&#39; example: x = Rset(&quot; SmallBASIC &quot;, 15) &#39; --&gt; x is &quot;    SmallBASIC &quot;
Func Rset(s, b)
  Local l = Len(s)

  If l &gt;= b Then
    Rset = Right(s, b)
  Else
    Rset = Space(b - l) + s
  Fi
End
</code></pre>
<p>Demo file, demo.bas, which is using strlib.bas above:</p>
<pre><code>&#39; Here we declare that this file is using another UNIT file.
&#39; Note: The actual file name must be in lower case for Linux OS.
Import strlib &#39; (without .bas extension)
&#39; Note: To access a member of a UNIT we must use the unit-name, a point
&#39;       and the name of the member, e.g. Strlib.Lset(&quot;Hello&quot;, 10).
&#39; demo:
Color 14, 1
Locate 4, 30
Print Strlib.Lset(&quot;  --&gt;&gt;&quot;, 25)
Locate 5, 30
Print Strlib.Lset(Strlib.Rset(&quot;This way...&quot;, 18), 25)
Locate 6, 30
Print Strlib.Rset(&quot;--&gt;&gt;  &quot;, 25)
Pause</code></pre>
  <div class="lavenderBox">
    <div class="header">Code samples using UNIT</div>
    <div class="linklist">
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//games 1/4tune.bas">4tune.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//units section/base64.bas">base64.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//games 3/bolmo.bas">bolmo.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//units section/crgb.bas">crgb.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//games 1/crow.bas">crow.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//games 1/dogstar5.bas">dogstar5.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//mathematics/matrix_solve.bas">matrix_solve.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//games 1/neolithic.bas">neolithic.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//units section/properties.bas">properties.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//games 1/rogue trader.bas">rogue trader.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//graphics 3/sierpinski in space.bas">sierpinski in space.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//graphics 4/space.bas">space.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//graphics 1/star_field.bas">star_field.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//games 3/star_field.bas">star_field.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//games 1/startrek.bas">startrek.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//games 3/startrek.bas">startrek.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//units section/strlib.bas">strlib.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//misc/Peter Graphics/try rainbow v2.bas">try rainbow v2.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//misc/Peter Graphics/try rainbow.bas">try rainbow.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//utilities/vigenere_cipher.bas">vigenere_cipher.bas </a>&nbsp;
    </div>
  </div>
  <div class="lavenderBox">
    <div class="header">System</div>
    <div class="linklist">
      <a href="/reference/1439.html">CHAIN </a>&nbsp;
      <a href="/reference/1521.html">COMMAND </a>&nbsp;
      <a href="/reference/1522.html">CWD </a>&nbsp;
      <a href="/reference/806.html">DELAY </a>&nbsp;
      <a href="/reference/807.html">ENV </a>&nbsp;
      <a href="/reference/815.html">ENV </a>&nbsp;
      <a href="/reference/1443.html">EXEC </a>&nbsp;
      <a href="/reference/1440.html">EXPORT </a>&nbsp;
      <a href="/reference/606.html">FRE </a>&nbsp;
      <a href="/reference/1525.html">HOME </a>&nbsp;
      <a href="/reference/1441.html">IMPORT </a>&nbsp;
      <a href="/reference/1462.html">INCLUDE </a>&nbsp;
      <a href="/reference/1736.html">MAXINT </a>&nbsp;
      <a href="/reference/1735.html">NIL </a>&nbsp;
      <a href="/reference/1442.html">OPTION </a>&nbsp;
      <a href="/reference/809.html">PAUSE </a>&nbsp;
      <a href="/reference/1524.html">PI </a>&nbsp;
      <a href="/reference/817.html">PROGLINE </a>&nbsp;
      <a href="/reference/810.html">RANDOMIZE </a>&nbsp;
      <a href="/reference/818.html">RUN </a>&nbsp;
      <a href="/reference/1523.html">SBVER </a>&nbsp;
      <a href="/reference/1734.html">SELF </a>&nbsp;
      <a href="/reference/812.html">STKDUMP </a>&nbsp;
      <a href="/reference/813.html">TROFF </a>&nbsp;
      <a href="/reference/814.html">TRON </a>&nbsp;
      <a href="/reference/1446.html"><strong>UNIT</strong> </a>&nbsp;
    </div>
    <div class="subtitle">
      If there is insufficient information on this page and you wish learn more about UNIT,
      please send an email to smallbasic@gmail.com. You can help to improve information about
UNIT by submitting a <a href="https://github.com/smallbasic/smallbasic.github.io/pulls">pull request</a>,
      click View Source for details. Note, an offline language reference text file is also available - see the Download section.
    </div>
  </div>
  <div class="categories">
    <a href="/pages/console.html">Console </a>
    <a href="/pages/data.html">Data </a>
    <a href="/pages/date.html">Date </a>
    <a href="/pages/file.html">File </a>
    <a href="/pages/graphics.html">Graphics </a>
    <a href="/pages/language.html">Language </a>
    <a href="/pages/math.html">Math </a>
    <a href="/pages/string.html">String </a>
    <a href="/pages/system.html">System </a>
  </div>
</div>
    <div class="pagefooter">
      This page was last edited on Fri, 21 Apr 2023 12:42:29 +0200
 |
      <a href="https://en.wikipedia.org/wiki/Markdown" target="_blank" rel="nofollow">Markdown</a>
      processed with
      <a href="https://pandoc.org/MANUAL.html#pandocs-markdown" target="_blank" rel="nofollow">pandoc 2.9.2.1</a>
      | Template by <a href="http://html5-templates.com/" target="_blank" rel="nofollow">HTML5 Templates</a>
    </div>
  </div>
</div>
  </body>
</html>
