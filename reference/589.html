<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SmallBASIC | DIRWALK</title>
  <meta name="description" content="Walk through the specified directories. The user-defined function must returns zero to stop the process.">
  <link rel="canonical" href="589">
  <link rel="keywords" href="DIRWALK directory [, wildcards] [USE ...]">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="icon" type="image/png" href="/images/sb-desktop-32x32.png">
  <script src="/clipboard.js"></script>
</head>
  <body>
<div class="wrapAll clearfix">
  <div class="sidebar">
    <div class="logo">
      <a href="/"><img src='/images/sb-desktop-128x128.png' alt="logo"></a>
    </div>
    <div class="navigation">
      <h4>SmallBASIC</h4>
      <ul>
        <li><a href="/">Main page</a></li>
        <li><a href="/pages/download.html">Download</a></li>
        <li><a href="/pages/reference.html">Language reference</a></li>
        <li><a href="/pages/samples.html">Code library</a></li>
      </ul>
      <hr class="menuSeparator"/>
      <ul>
        <li><a href="/pages/articles.html">Articles</a></li>
        <li><a href="/pages/community.html">Community</a></li>
        <li><a href="/pages/changelog.html">Changelog</a></li>
        <li><a href="/pages/screenshots.html">Screenshots</a></li>
        <li><a href="/pages/links.html">Links</a></li>
      </ul>
    </div>
  </div>
  <div class="mainsection">
    <div class="tabs clearfix">
      <div class="tabsLeft">
        <ul>
          <li><a href="#" class="active">Article</a></li>
          <li><a href="https://www.syntaxbomb.com/smallbasic">Discuss</a></li>
        </ul>
      </div>
      <div id="simpleSearch">
        <form action="https://github.com/smallbasic/smallbasic.github.io/search"
              target="_github" accept-charset="UTF-8" method="get" style="display:inline">
          <div id="submitSearch">
            <button type="submit">&nbsp;</button>
            <input type="hidden" class="js-site-search-type-field" name="type">
            <input type="hidden" name="utf8" value="âœ“">
            <input type="hidden" name="l" value="Visual Basic">
            <input type="text" name="q" placeholder="Search" id="searchInput">
          </div>
        </form>
      </div>
      <div class="tabsRight">
        <ul>
          <li><a target="_github" href="https://github.com/smallbasic/smallbasic.github.io/blob/master/_build/reference/589-file-dirwalk.markdown">View source</a></li>
          <li><a target="_github" href="https://github.com/smallbasic/smallbasic.github.io/commits/master/_build/reference/589-file-dirwalk.markdown">View history</a></li>
        </ul>
      </div>
    </div>
<div class="article">
  <h1>DIRWALK</h1>
  <blockquote>DIRWALK dir [, wildcards] [USE f(x)]</blockquote>
  <div class="siteSub">
    <p>
      <a href="/">Home</a> &gt;
      <a href="/pages/reference.html">Reference</a> &gt;
      <a href="/pages/file.html">File</a>
    </p>
  </div>
<p>Walk through the specified directory <code>dir</code> and its
subdirectories. The user defined function <code>f(x)</code> takes
<code>x</code> as a parameter. <code>x</code> contains information about
the current file. <code>f(x)</code> must return zero to stop the
process. <code>wildcards</code> can be used to filter the files.</p>
<h3 id="example-1-print-all-files">Example 1: Print all files</h3>
<div class="sourceCode" id="cb1"><pre
class="sourceCode smallbasic"><code class="sourceCode smallbasic"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FUNC </span>PRNF(x)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  ? x</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  PRNF=<span class="dt">TRUE</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">END</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">DIRWALK</span> <span class="st">&quot;.&quot;</span> <span class="kw">USE</span> PRNF(x)</span></code></pre></div>
<h3 id="example-2-create-a-list-of-all-files">Example 2: Create a list
of all files</h3>
<div class="sourceCode" id="cb2"><pre
class="sourceCode smallbasic"><code class="sourceCode smallbasic"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FUNC </span>ListFiles(x)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  FileList &lt;&lt; x</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">return</span> <span class="dt">true</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">END</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">DIRWALK</span> <span class="st">&quot;.&quot;</span> <span class="kw">USE</span> ListFiles(x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="kw">for </span>n <span class="kw">in</span> FileList</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">print</span> n.path, n.name</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="kw">next</span></span></code></pre></div>
<h3 id="example-3-search-for-a-certain-file-using-wildcards">Example 3:
Search for a certain file using wildcards</h3>
<div class="sourceCode" id="cb3"><pre
class="sourceCode smallbasic"><code class="sourceCode smallbasic"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FUNC </span>ListFiles(x)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  FileList &lt;&lt; x</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">return</span> <span class="dt">true</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">END</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">DIRWALK</span> <span class="st">&quot;.&quot;</span>, <span class="st">&quot;scratch.bas&quot;</span> <span class="kw">USE</span> ListFiles(x)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="kw">for </span>n <span class="kw">in</span> FileList</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">print</span> n.path</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="kw">next</span></span></code></pre></div>
<h3
id="example-4-search-a-certain-file-using-user-defined-function">Example
4: Search a certain file using user defined function</h3>
<div class="sourceCode" id="cb4"><pre
class="sourceCode smallbasic"><code class="sourceCode smallbasic"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">func </span>SearchFile(x)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">if(</span>x.name == <span class="st">&quot;scratch.bas&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    path = x.path</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="dt">false</span>   <span class="co">&#39; file found, stop dirwalk</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">endif</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">return</span> <span class="dt">true</span>      <span class="co">&#39; file not found yet, continue dirwalk</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">DIRWALK</span> <span class="st">&quot;.&quot;</span> <span class="kw">USE</span> SearchFile(x)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="kw">print</span> path</span></code></pre></div>
<h3 id="example-5-using-wilcards">Example 5: Using wilcards</h3>
<div class="sourceCode" id="cb5"><pre
class="sourceCode smallbasic"><code class="sourceCode smallbasic"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FUNC </span>ListFiles(x)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  FileList &lt;&lt; x</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">return</span> <span class="dt">true</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">END</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">DIRWALK</span> <span class="st">&quot;.&quot;</span>, <span class="st">&quot;*.bas&quot;</span> <span class="kw">USE</span> ListFiles(x)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="kw">for </span>n <span class="kw">in</span> FileList</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">print</span> n.path, n.name</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="kw">next</span></span></code></pre></div>
<h3 id="example-6-file-list-utility">Example 6: File list utility</h3>
<div class="sourceCode" id="cb6"><pre
class="sourceCode smallbasic"><code class="sourceCode smallbasic"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">&#39; Note: this demo is also a useful utility (version 2)</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">&#39; -------------------- Start of Demo search ---------------------</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">&#39; &quot;.&quot; = Start search in current directory:</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>dir = <span class="st">&quot;.&quot;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">&#39; Exclude some binary files to speed up search (it&#39;s not case sensitive):</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>exclude_ext = <span class="st">&quot;jpeg jpg png gif mp3 mp4 zip 7z exe dat&quot;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">&#39; Search this &quot;string&quot;:</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>word = <span class="st">&quot;FUNC &quot;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">&#39; 0 = Not case sensitive search; 1 = Case sensitive search:</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>case_sensitive = <span class="dv">0</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">&#39; Search it!</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>search_word dir, exclude_ext, word, case_sensitive</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">&#39; &#39; Demo only for dir_list():</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">&#39; a = dir_list(dir, exclude_ext)</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">&#39; For i In a Do ? i</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">&#39; ? &quot; - Length of list: &quot;; Len(a)</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">&#39; -------------------- End of Demo search ---------------------</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">&#39; Purpose: return sorted array of directory files-list (including files in</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;          sub-directories, but not directory-names).</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co">&#39; Details: &quot;dir&quot; is the top directory to start search from (default = &quot;.&quot;);</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;          &quot;exclude_ext&quot; is a Not case sensitive string of file-extension(s)</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;          to exclude from list (default = &quot;&quot;), For example:</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;           &quot;jpeg jpg zip z7 gif wav mp3&quot; &#39; Space delimited extensions.</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="co">&#39; Example:</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;  a = dir_list(&quot;&quot;, &quot;&quot;)  &#39; a is all files in current dir (and its sub-dirs).</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;  a = dir_list(&quot;..&quot;, &quot;bak zip&quot;) &#39; a is files in upper dir, exclude .bak .zip</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="kw">Func </span>dir_list(dir, exclude_ext)</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Local</span> a, ext</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">&#39; Verify &quot;dir&quot; (&quot;.&quot; is current directory):</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  dir = <span class="fu">Trim</span>(dir): <span class="kw">If </span>dir = <span class="st">&quot;&quot;</span> <span class="kw">Then di</span>r = <span class="st">&quot;.&quot;</span>            <span class="co">&#39;</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">&#39; Exclude extension in Any case (for Windows):</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  ext = <span class="fu">Enclose</span>(<span class="fu">Lcase</span>(<span class="fu">Squeeze</span>(exclude_ext)), <span class="st">&quot; &quot;</span>)</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">&#39; Make the dir list (DIRWALK):</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  <span class="kw">Func </span>make_list(f)</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Local</span> e                             <span class="co">&#39; File Extension (without &quot;.&quot;)</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">If </span><span class="fu">Isfile</span>(f) <span class="kw">Then</span>                   <span class="co">&#39; Don&#39;t add directory-names to list</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>      e = <span class="fu">Enclose</span>(<span class="fu">Lcase</span>(<span class="fu">Rightoflast</span>(f, <span class="st">&quot;.&quot;</span>)), <span class="st">&quot; &quot;</span>)</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>      <span class="kw">If Not</span> (e <span class="kw">In</span> ext) <span class="kw">Then a </span>&lt;&lt; f     <span class="co">&#39; Exclude extension? or append file</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Fi</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    make_list = <span class="dt">True</span>                    <span class="co">&#39; (True = Continue to walk)</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>  <span class="kw">End Func</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Dirwalk</span> dir <span class="kw">Use</span> make_list(x)          <span class="co">&#39; (Note: parameter name must be &#39;x&#39;)</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>  <span class="co">&#39; Sort dir list and ignore case (SORT):</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>  <span class="kw">Func </span>no_case(x, y)</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>    x = <span class="fu">Lcase</span>(x)</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>    y = <span class="fu">Lcase</span>(y)</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Select Case </span><span class="dv">1</span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Case</span> x = y: no_case =  <span class="dv">0</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Case</span> x &gt; y: no_case = +<span class="dv">1</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Case</span> <span class="kw">Else</span> : no_case = -<span class="dv">1</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>    <span class="kw">End Select</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>  <span class="kw">End Func</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sort</span> a <span class="kw">Use</span> no_case(x, y)</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>  dir_list = a</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a><span class="kw">End Func</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a><span class="co">&#39; Purpose: search for a &quot;word&quot; in &quot;dir&quot; (and its sub-dirs), and print results.</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a><span class="co">&#39; Details: for &quot;dir&quot; and &quot;exclude_ext&quot; details - See dir_list() function.</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;          &quot;word&quot; is the string to search for.</span></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;          &#39;cs&#39; is case sensitive search - True or False.</span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a><span class="kw">Sub </span>search_word(dir, exclude_ext, word, cs)</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Local</span> w, file, list, l, lines, p     <span class="co">&#39; For Searching</span></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Local</span> c_page, c_line                 <span class="co">&#39; Counters</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Local</span> t_lines, t_files, old_t_lines  <span class="co">&#39; Totals (for sum)</span></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Local</span> LINES_PER_PAGE, attr = <span class="dv">3</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>  LINES_PER_PAGE = <span class="dv">10</span>                 <span class="co">&#39; How many lines to print before pause?</span></span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>  list = dir_list(dir, exclude_ext)    <span class="co">&#39; Get the list of all files</span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>  w = <span class="kw">Iff</span>(cs, word, <span class="fu">Ucase</span>(word))       <span class="co">&#39; Case sensitive search?</span></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>  ? <span class="fu">Cat</span>(<span class="dv">0</span>); <span class="fu">Chr</span>(<span class="dv">12</span>); <span class="fu">Cat</span>(attr);        <span class="co">&#39; Clear console attributes and screen</span></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>  <span class="co">&#39; Load and search in each file:</span></span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>  <span class="kw">For </span>file <span class="kw">In</span> list</span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Tload</span> file, lines</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>    c_line = <span class="dv">0</span></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>    <span class="co">&#39; Search in each line:</span></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>    <span class="kw">For </span>l <span class="kw">In</span> lines</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>      c_line++  <span class="co">&#39; Keep line # for [print the line]</span></span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>      <span class="co">&#39; Look for the word in this line:</span></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>      <span class="kw">If </span>cs <span class="kw">Then</span></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>        p = <span class="fu">Instr</span>(l, w)</span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>      <span class="kw">Else</span></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>        p = <span class="fu">Instr</span>(<span class="fu">Ucase</span>(l), w)</span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>      <span class="kw">Fi</span></span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>      <span class="co">&#39; If word found then print the line:</span></span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>      <span class="kw">If </span>p <span class="kw">Then</span></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>        ? <span class="fu">Cat</span>(<span class="dv">2</span>); file + <span class="st">&quot; [&quot;</span> + c_line + <span class="st">&quot;]&quot;</span>; <span class="fu">Cat</span>(-<span class="dv">2</span>); <span class="st">&quot; &quot;</span>; <span class="fu">Mid</span>(l, p)</span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>        c_page++</span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>        <span class="kw">If </span>c_page = LINES_PER_PAGE <span class="kw">Then c_</span>page = <span class="dv">0</span>: <span class="kw">Pause</span></span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a>        t_lines++  <span class="co">&#39; Keep total lines # for sum</span></span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a>      <span class="kw">Fi</span></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Next </span>l</span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>    <span class="kw">If </span>t_lines &gt; old_t_lines <span class="kw">Then</span></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a>      old_t_lines = t_lines</span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a>      attr = -attr: ? <span class="fu">Cat</span>(attr);  <span class="co">&#39; Change color on new file</span></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a>      t_files++                   <span class="co">&#39; Keep total files # for sum</span></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Fi</span></span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>  <span class="kw">Next </span>file</span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a>  <span class="co">&#39; Print sum:</span></span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a>  <span class="kw">If </span>c_page &lt;&gt; <span class="dv">0</span> <span class="kw">Then Pa</span>use</span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a>  ? <span class="fu">Cat</span>(<span class="dv">0</span>)  <span class="co">&#39; Clear all console attributes</span></span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Color</span> <span class="dv">15</span></span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a>  ? <span class="st">&quot;- Search in: &quot;</span>; <span class="fu">Enclose</span>(dir)</span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a>  ? <span class="st">&quot;- Exclude file-extension(s): &quot;</span>; <span class="fu">Enclose</span>(<span class="fu">Squeeze</span>(exclude_ext))</span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a>  ? <span class="st">&quot;- Search &quot;</span>; <span class="kw">Iff</span>(cs, <span class="st">&quot;IS&quot;</span>, <span class="st">&quot;is NOT&quot;</span>); <span class="st">&quot; case sensitive.&quot;</span></span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a>  ? <span class="st">&quot;- Found &quot;</span>; <span class="fu">Enclose</span>(word); &amp;</span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; in &quot;</span>; t_lines; <span class="st">&quot; lines, in &quot;</span>; t_files; <span class="st">&quot; files &quot;</span>; &amp;</span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;(out of &quot;</span>; <span class="fu">Len</span>(list); <span class="st">&quot; files).&quot;</span></span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a>  ?</span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Color</span> <span class="dv">7</span></span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a>  ? <span class="st">&quot;Done. Press Backspace key...&quot;</span>;</span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a>  <span class="kw">While Inkey</span> &lt;&gt; <span class="fu">Chr</span>(<span class="dv">8</span>): <span class="kw">Wend</span></span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a><span class="kw">End Sub</span></span></code></pre></div>
  <div class="lavenderBox">
    <div class="header">File</div>
    <div class="linklist">
      <a href="/reference/580.html">ACCESS </a>&nbsp;
      <a href="/reference/602.html">BGETC </a>&nbsp;
      <a href="/reference/582.html">BLOAD </a>&nbsp;
      <a href="/reference/583.html">BPUTC </a>&nbsp;
      <a href="/reference/584.html">BSAVE </a>&nbsp;
      <a href="/reference/585.html">CHDIR </a>&nbsp;
      <a href="/reference/586.html">CHMOD </a>&nbsp;
      <a href="/reference/587.html">CLOSE </a>&nbsp;
      <a href="/reference/588.html">COPY </a>&nbsp;
      <a href="/reference/589.html"><strong>DIRWALK</strong> </a>&nbsp;
      <a href="/reference/603.html">EOF </a>&nbsp;
      <a href="/reference/604.html">EXIST </a>&nbsp;
      <a href="/reference/605.html">FILES </a>&nbsp;
      <a href="/reference/607.html">FREEFILE </a>&nbsp;
      <a href="/reference/590.html">INPUT </a>&nbsp;
      <a href="/reference/608.html">INPUT </a>&nbsp;
      <a href="/reference/591.html">KILL </a>&nbsp;
      <a href="/reference/592.html">LOCK </a>&nbsp;
      <a href="/reference/609.html">LOF </a>&nbsp;
      <a href="/reference/593.html">MKDIR </a>&nbsp;
      <a href="/reference/594.html">OPEN </a>&nbsp;
      <a href="/reference/601.html">READ </a>&nbsp;
      <a href="/reference/595.html">RENAME </a>&nbsp;
      <a href="/reference/596.html">RMDIR </a>&nbsp;
      <a href="/reference/597.html">SEEK </a>&nbsp;
      <a href="/reference/610.html">SEEK </a>&nbsp;
      <a href="/reference/598.html">TLOAD </a>&nbsp;
      <a href="/reference/599.html">TSAVE </a>&nbsp;
      <a href="/reference/600.html">WRITE </a>&nbsp;
    </div>
    <div class="subtitle">
      If there is insufficient information on this page and you wish learn more about DIRWALK,
      please send an email to smallbasic@gmail.com. You can help to improve information about
DIRWALK by submitting a <a href="https://github.com/smallbasic/smallbasic.github.io/pulls">pull request</a>,
      click View Source for details. Note, an offline language reference text file is also available - see the Download section.
    </div>
  </div>
  <div class="categories">
    <a href="/pages/console.html">Console </a>
    <a href="/pages/data.html">Data </a>
    <a href="/pages/date.html">Date </a>
    <a href="/pages/file.html">File </a>
    <a href="/pages/graphics.html">Graphics </a>
    <a href="/pages/language.html">Language </a>
    <a href="/pages/math.html">Math </a>
    <a href="/pages/string.html">String </a>
    <a href="/pages/system.html">System </a>
  </div>
</div>
    <div class="pagefooter">
      This page was last edited on Mon, 23 Oct 2023 15:43:28 +0200
 |
      <a href="https://en.wikipedia.org/wiki/Markdown" target="_blank" rel="nofollow">Markdown</a>
      processed with
      <a href="https://pandoc.org/MANUAL.html#pandocs-markdown" target="_blank" rel="nofollow">pandoc 3.1.3</a>
      | Template by <a href="http://html5-templates.com/" target="_blank" rel="nofollow">HTML5 Templates</a>
    </div>
  </div>
</div>
  </body>
</html>
