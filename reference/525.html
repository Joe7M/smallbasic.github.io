<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SmallBASIC | FORM</title>
  <meta name="description" content="Creates a form object from a MAP variable. This provides access to the following sub-commands: doEvents, close, refresh. The form MAP may contain the following properties: value, inputs, focus. Inputs is an array of MAP, each may contain the following properties: x, y, width, height, value, label, name, type, backgroundColor, color, visible, isExit, selectedIndex, length, noFocus, onclick">
  <link rel="canonical" href="525">
  <link rel="keywords" href="FORM(map)">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="icon" type="image/png" href="/images/sb-desktop-32x32.png">
  <script src="/clipboard.js"></script>
</head>
  <body>
<div class="wrapAll clearfix">
  <div class="sidebar">
    <div class="logo">
      <a href="/"><img src='/images/sb-desktop-128x128.png' alt="logo"></a>
    </div>
    <div class="navigation">
      <h4>SmallBASIC</h4>
      <ul>
        <li><a href="/">Main page</a></li>
        <li><a href="/pages/download.html">Download</a></li>
        <li><a href="/pages/reference.html">Language reference</a></li>
        <li><a href="/pages/samples.html">Code library</a></li>
      </ul>
      <hr class="menuSeparator"/>
      <ul>
        <li><a href="/pages/articles.html">Articles</a></li>
        <li><a href="/pages/community.html">Community</a></li>
        <li><a href="/pages/changelog.html">Changelog</a></li>
        <li><a href="/pages/screenshots.html">Screenshots</a></li>
        <li><a href="/pages/links.html">Links</a></li>
      </ul>
    </div>
  </div>
  <div class="mainsection">
    <div class="tabs clearfix">
      <div class="tabsLeft">
        <ul>
          <li><a href="#" class="active">Article</a></li>
          <li><a href="https://www.syntaxbomb.com/smallbasic">Discuss</a></li>
        </ul>
      </div>
      <div id="simpleSearch">
        <form action="https://github.com/smallbasic/smallbasic.github.io/search"
              target="_github" accept-charset="UTF-8" method="get" style="display:inline">
          <div id="submitSearch">
            <button type="submit">&nbsp;</button>
            <input type="hidden" class="js-site-search-type-field" name="type">
            <input type="hidden" name="utf8" value="✓">
            <input type="hidden" name="l" value="Visual Basic">
            <input type="text" name="q" placeholder="Search" id="searchInput">
          </div>
        </form>
      </div>
      <div class="tabsRight">
        <ul>
          <li><a target="_github" href="https://github.com/smallbasic/smallbasic.github.io/blob/master/_build/reference/525-console-form.markdown">View source</a></li>
          <li><a target="_github" href="https://github.com/smallbasic/smallbasic.github.io/commits/master/_build/reference/525-console-form.markdown">View history</a></li>
        </ul>
      </div>
    </div>
<div class="article">
  <h1>FORM</h1>
  <blockquote>FORM(map)</blockquote>
  <div class="siteSub">
    <p>
      <a href="/">Home</a> &gt;
      <a href="/pages/reference.html">Reference</a> &gt;
      <a href="/pages/console.html">Console</a>
    </p>
  </div>
</blockquote>
<p>Creates a form object <code>f</code> from a MAP variable <code>formMap</code>. Form object <code>f</code> gives access to the following GUI elements:</p>
<ul>
<li>Push button</li>
<li>Label</li>
<li>Hyperlinked text</li>
<li>Listbox</li>
<li>Dropdown listbox</li>
<li>Single or multi-line text input</li>
<li>Image button</li>
</ul>
<p>In listboxes and dropdown listboxes press and hold mouse button to scroll through the items. Alternatively arrow keys can be used. Press return or space for selecting the highlighted item.</p>
<h3 id="the-form-object">The form object</h3>
<p><code>f = form(formMAP)</code> provides access to the following sub-commands of the form object <code>f</code>:</p>
<table>
<colgroup>
<col style="width: 29%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="header">
<th>Sub-command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>doEvents()</td>
<td>Process system events for mouse and keyboard handling.</td>
</tr>
<tr class="even">
<td>close()</td>
<td>Closes the active FORM.</td>
</tr>
<tr class="odd">
<td>refresh(n)</td>
<td>n = 1 Copy the UI state into the FORM input variables. n = 0 Update the UI state using the FORM input variables.</td>
</tr>
</tbody>
</table>
<p>The form object <code>f</code> may contain the following properties:</p>
<table>
<thead>
<tr class="header">
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>value</td>
<td>The value from the active input field.</td>
</tr>
<tr class="even">
<td><strong>inputs</strong></td>
<td>Array of inputs.</td>
</tr>
<tr class="odd">
<td>focus</td>
<td>Index to the focused input.</td>
</tr>
</tbody>
</table>
<h3 id="defining-the-input-fields">Defining the input fields</h3>
<p><code>inputs</code> is an array of type MAP, each element may contain the following attributes:</p>
<table>
<thead>
<tr class="header">
<th>Attribute</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>x</td>
<td>X coordinate.</td>
</tr>
<tr class="even">
<td>y</td>
<td>Y coordinate.</td>
</tr>
<tr class="odd">
<td>width</td>
<td>Width.</td>
</tr>
<tr class="even">
<td>height</td>
<td>Height.</td>
</tr>
<tr class="odd">
<td>value</td>
<td>The internal value associated with the input.</td>
</tr>
<tr class="even">
<td>label</td>
<td>The display label for the input.</td>
</tr>
<tr class="odd">
<td>name</td>
<td>The name of the input.</td>
</tr>
<tr class="even">
<td><strong>type</strong></td>
<td>The type of input, see below.</td>
</tr>
<tr class="odd">
<td>help</td>
<td>Listbox or single line text input help text.</td>
</tr>
<tr class="even">
<td>backgroundColor</td>
<td>Background color.</td>
</tr>
<tr class="odd">
<td>color</td>
<td>Forground color.</td>
</tr>
<tr class="even">
<td>isExit</td>
<td>Whether clicking the input exits the current program.</td>
</tr>
<tr class="odd">
<td>isExternal</td>
<td>Whether the <code>link</code> field opens in an external browser.</td>
</tr>
<tr class="even">
<td>resizable</td>
<td>Whether the field can be resized.</td>
</tr>
<tr class="odd">
<td>visible</td>
<td>Whether the input field is visible.</td>
</tr>
<tr class="even">
<td>selectedIndex</td>
<td>The selected item in a listbox or choice.</td>
</tr>
<tr class="odd">
<td>length</td>
<td>Length of a TEXT input field in number of characters.</td>
</tr>
<tr class="even">
<td>noFocus</td>
<td>The input cannot receive focus.</td>
</tr>
<tr class="odd">
<td>onclick</td>
<td>SUB to invoke when clicked.</td>
</tr>
</tbody>
</table>
<p>The type attribute can be one of the following:</p>
<table>
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“button”</td>
<td>Push button.</td>
</tr>
<tr class="even">
<td>“label”</td>
<td>Display label.</td>
</tr>
<tr class="odd">
<td>“link”</td>
<td>Hyperlinked text.</td>
</tr>
<tr class="even">
<td>“listbox”</td>
<td>Listbox.</td>
</tr>
<tr class="odd">
<td>“choice”</td>
<td>Dropdown listbox.</td>
</tr>
<tr class="even">
<td>“text”</td>
<td>Single or multi-line text input.</td>
</tr>
<tr class="odd">
<td>“image”</td>
<td>Image button.</td>
</tr>
</tbody>
</table>
<h3 id="example-1-creating-a-push-button">Example 1: Creating a push button</h3>
<pre><code>button.type = &quot;button&quot;
button.x = 120
button.y = 120
button.label = &quot;Button&quot;
button.backgroundcolor = rgb(60, 60, 60)
button.onclick = @ButtonClicked     &#39; Callback function, definition see below

formMAP.inputs &lt;&lt; button

f = form(formMAP)

while 1
  f.doEvents()
wend

f.close()

sub ButtonClicked()
  at 0,0
  Clicked++
  print &quot;Button clicked &quot; + Clicked + &quot; times&quot;
end</code></pre>
<h3 id="example-2-creating-a-label">Example 2: creating a label</h3>
<pre><code>l.type = &quot;label&quot;
l.x = 120
l.y = 120
l.label = &quot;Label&quot;
l.color = rgb(255, 60, 60)

f.inputs &lt;&lt; l

f = form(f)

while 1
  f.doEvents()
wend

f.close()</code></pre>
<h3 id="example-3-creating-a-link-to-an-external-website">Example 3: Creating a link to an external website</h3>
<pre><code>l.type = &quot;link&quot;
l.x = 120
l.y = 120
l.label = &quot;Link to SmallBASIC website&quot;
l.value = &quot;https://smallbasic.github.io&quot;
l.isExternal = true
l.color = rgb(100, 100, 255)

f.inputs &lt;&lt; l

f = form(f)

while 1
  f.doEvents()
wend

f.close()</code></pre>
<h3 id="example-4-creating-a-listbox">Example 4: Creating a listbox</h3>
<pre><code>l.type = &quot;listbox&quot;
l.x = 120
l.y = 120
l.height = 200
l.width = 100
l.value = &quot;cats|dogs|fish|birds|insects&quot;
l.color = rgb(255, 255, 255)
l.backgroundColor = rgb(100, 100, 100)

f.inputs &lt;&lt; l

f = form(f)

while 1
  f.doEvents()
  
  &#39; Check for value of the active input field
  if (len(f.value) &gt; 0) then
    at 0,0
    print f.value; &quot;                  &quot;
  end if  
wend

f.close()</code></pre>
<h3 id="example-5-creating-a-dropdown-listbox">Example 5: Creating a dropdown listbox</h3>
<pre><code>l.type = &quot;choice&quot;
l.x = 120
l.y = 120
l.width = 100
l.value = &quot;cats|dogs|fish|birds|insects&quot;
l.color = rgb(255, 255, 255)
l.backgroundColor = rgb(100, 100, 100)

f.inputs &lt;&lt; l

f = form(f)

while 1
  f.doEvents()
  
  &#39; Check for value of the active input field
  if (len(f.value) &gt; 0) then
    at 0,0
    print f.value; &quot;                  &quot;
  end if  
wend

f.close()</code></pre>
<h3 id="example-6-creating-a-text-input-field">Example 6: Creating a text input field</h3>
<pre><code>t.type = &quot;text&quot;
t.x = 120
t.y = 120
t.width = 300
t.value = &quot;Add more text&quot;
&#39; t.height = 100  &#39; if hight is not defined, single line field
t.color = rgb(255, 255, 255)
t.backgroundColor = rgb(100, 100, 100)
t.length = 50 &#39; number of characters

&#39; create additionally an OK-Button to update the form object
&#39; otherwise the text field blocks loop
b.type = &quot;button&quot;
b.x = 120 + t.width + 10
b.y = 120 
b.label = &quot;OK&quot;
b.backgroundcolor = rgb(60, 60, 60)
b.onclick = @OKButtonClicked
f.inputs &lt;&lt; t
f.inputs &lt;&lt; b

f = form(f)

while 1
  f.doEvents()  
wend

f.close()

sub OKButtonClicked()
   f.refresh(1)              &#39; Update the form object
   at 0,0
   print f.inputs[0].value   &#39; Text field is the first element added to the formMAP
end</code></pre>
<h3 id="example-one-more-example">Example: One more example</h3>
<pre><code>f.handleKeys = 0
&#39; create some buttons
button1.y = 120
button1.label = &quot;Button1&quot;
button1.value = &quot;valueofButton1&quot;
button1.backgroundcolor = rgb(255,0,0)
button1.onclick = @HelloWorld &#39;this prints on load
button2.x = -1
button2.y = 120
button2.label = &quot;Button2&quot;
button2.value = &quot;valueofButton2&quot;
button3.value = &quot;cats&quot;
button3.x = -1
button3.y = 120
button3.background = 223344
b4.type = &quot;choice&quot;
b4.value = &quot;cats|dogs|Fish|cats|dogs|Fish|cats|dogs|Fish|cats|dogs|Fish&quot;
b4.selectedIndex = 2
b4.x = -1
b4.y = 120
b5.type = &quot;list&quot;
b5.value = &quot;cats|dogs|Fish|cats|dogs|Fish|cats|dogs|Fish|cats|dogs|Fish|end|lol&quot;
b5.x = -1
b5.y = 120
b5.height = 120
b6.type = &quot;text&quot;
b6.value = &quot;cats&quot;
b6.length=30
b6.x = -1
b6.y = 120
b6.width = 50
b6.noFocus = 0
&#39; add buttons to the form
f.inputs &lt;&lt; button1
f.inputs &lt;&lt; button2
f.inputs &lt;&lt; button3
f.inputs &lt;&lt; b4
f.inputs &lt;&lt; b5
f.inputs &lt;&lt; b6
f.backgroundcolor = &quot;green&quot;
&#39; at this stage &#39;f&#39; is just a plain user defined structure (map)
&#39; after calling FORM, &#39;f&#39; becomes a system form object with three special functions
&#39; doEvents, close and refresh (see sokoban.bas for refresh)
f = form(f)
&#39; the string version of the form is JSON  (see https://en.wikipedia.org/wiki/JSON)
TSAVE &quot;f.frm&quot;, f
while 1
  &#39; pump the system event queue
  f.doEvents()
  &#39; process the event
  in$ = inkey
  at 0,0
  if len(in$)&gt;1 then
    flag= asc(left(in$,1))
    keychar =right(in$,1)
  n= asc(keychar)
    if (flag == 1)
      ? &quot;Ctrl    : &quot;;keychar ; &quot;   &quot;
    else if (flag == 2)
      ? &quot;Alt    : &quot;; keychar
    else if (flag == 3)
      ? &quot;Ctrl+Alt: &quot;; keychar ; &quot;   &quot;
    else
      ? &quot;Arrow: &quot;; n ; &quot;   &quot;
    end if
  else
    vkey = asc(in$)
    if (vkey == 8) then
      ? &quot;backspace!&quot;
    else if (vkey == 127) then
      ? &quot;delete !&quot;
    else
      ? &quot; key=           &quot;; in$; &quot; &quot;; vkey
    endif
endif
if b6.value &lt;&gt; &quot;cats&quot; then ? b6.value
  if (len(f.value) &gt; 0) then
    print f.value; &quot;                  &quot;
  end if
wend
f.close()
func HelloWorld
? &quot;hello world&quot;
end</code></pre>
  <div class="lavenderBox">
    <div class="header">Code samples using FORM</div>
    <div class="linklist">
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//000 getting started/002 numeric variables.bas">002 numeric variables.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//games 1/7gables.bas">7gables.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//misc/Misc Bpf/Another center finder.bas">Another center finder.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//mathematics/bairstow.bas">bairstow.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//units section/base64.bas">base64.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//games 1/betrayal: crows ii.bas">betrayal: crows ii.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//graphics 1/biorythms.bas">biorythms.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//applications/calc.bas">calc.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//applications/calculator.bas">calculator.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//games 1/checkers.bas">checkers.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//games 3/checkers.bas">checkers.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//games 1/chess.bas">chess.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//games 3/chess.bas">chess.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//misc/Misc Bpf/circumscribe triangle.bas">circumscribe triangle.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//graphics 1/conrec-sb-v01.bas">conrec-sb-v01.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//games 1/dogstar5.bas">dogstar5.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//network/duckduckgo.bas">duckduckgo.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//applications/filemanager.bas">filemanager.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//mathematics/first factors mga.bas">first factors mga.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//graphics 4/fizzle2.bas">fizzle2.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//code demos/form demo.bas">form demo.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//gp utm package/gridareaplot.bas">gridareaplot.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//games 1/illuminati.bas">illuminati.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master///index.bas">index.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//mathematics/leastq.bas">leastq.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//business/loancalc.bas">loancalc.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//graphics 2/mandelbrot explorer.bas">mandelbrot explorer.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//mathematics/matrix_solve.bas">matrix_solve.bas </a>&nbsp;
      <a target="_github" href="https://raw.githubusercontent.com/smallbasic/smallbasic.samples/master//applications/memoryTest.bas">memoryTest.bas </a>&nbsp;
    </div>
  </div>
  <div class="lavenderBox">
    <div class="header">Console</div>
    <div class="linklist">
      <a href="/reference/521.html">AT </a>&nbsp;
      <a href="/reference/522.html">BEEP </a>&nbsp;
      <a href="/reference/538.html">CAT </a>&nbsp;
      <a href="/reference/524.html">CLS </a>&nbsp;
      <a href="/reference/1015.html">DEFINEKEY </a>&nbsp;
      <a href="/reference/525.html"><strong>FORM</strong> </a>&nbsp;
      <a href="/reference/539.html">INKEY </a>&nbsp;
      <a href="/reference/527.html">INPUT </a>&nbsp;
      <a href="/reference/528.html">LINEINPUT </a>&nbsp;
      <a href="/reference/529.html">LINPUT </a>&nbsp;
      <a href="/reference/530.html">LOCATE </a>&nbsp;
      <a href="/reference/531.html">LOGPRINT </a>&nbsp;
      <a href="/reference/532.html">NOSOUND </a>&nbsp;
      <a href="/reference/533.html">PEN </a>&nbsp;
      <a href="/reference/534.html">PLAY </a>&nbsp;
      <a href="/reference/535.html">PRINT </a>&nbsp;
      <a href="/reference/536.html">SOUND </a>&nbsp;
      <a href="/reference/540.html">TAB </a>&nbsp;
    </div>
    <div class="subtitle">
      If there is insufficient information on this page and you wish learn more about FORM,
      please send an email to smallbasic@gmail.com. You can help to improve information about
FORM by submitting a <a href="https://github.com/smallbasic/smallbasic.github.io/pulls">pull request</a>,
      click View Source for details. Note, an offline language reference text file is also available - see the Download section.
    </div>
  </div>
  <div class="categories">
    <a href="/pages/console.html">Console </a>
    <a href="/pages/data.html">Data </a>
    <a href="/pages/date.html">Date </a>
    <a href="/pages/file.html">File </a>
    <a href="/pages/graphics.html">Graphics </a>
    <a href="/pages/language.html">Language </a>
    <a href="/pages/math.html">Math </a>
    <a href="/pages/string.html">String </a>
    <a href="/pages/system.html">System </a>
  </div>
</div>
    <div class="pagefooter">
      This page was last edited on Tue, 28 Feb 2023 23:03:12 +0100
 |
      <a href="https://en.wikipedia.org/wiki/Markdown" target="_blank" rel="nofollow">Markdown</a>
      processed with
      <a href="https://pandoc.org/MANUAL.html#pandocs-markdown" target="_blank" rel="nofollow">pandoc 2.9.2.1</a>
      | Template by <a href="http://html5-templates.com/" target="_blank" rel="nofollow">HTML5 Templates</a>
    </div>
  </div>
</div>
  </body>
</html>
