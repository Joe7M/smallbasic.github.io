<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SmallBASIC | vade_control</title>
  <meta name="description" content="SmallBASIC | One more basic">
  <link rel="canonical" href="/vade_control.html">
  <link rel="keywords" href="vade_control">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="icon" type="image/png" href="/images/sb-desktop-32x32.png">
</head>
  <body>
<div class="wrapAll clearfix">
  <div class="sidebar">
    <div class="logo">
      <a href="/index.html"><img src='/images/sb-desktop-128x128.png' alt="logo"></a>
    </div>
    <div class="navigation">
      <h4>SmallBASIC</h4>
      <ul>
        <li><a href="/index.html">Main page</a></li>
        <li><a href="/pages/download.html">Download</a></li>
        <li><a href="/pages/reference.html">Language reference</a></li>
        <li><a href="/pages/samples.html">Code library</a></li>
      </ul>
      <hr class="menuSeparator"/>
      <ul>
        <li><a href="/pages/articles.html">Artices</a></li>
        <li><a href="/pages/community.html">Community</a></li>
        <li><a href="/pages/changelog.html">ChangeLog</a></li>
        <li><a href="/pages/screenshots.html">Screenshots</a></li>
        <li><a href="/pages/links.html">Links</a></li>
      </ul>
    </div>
  </div>
  <div class="mainsection">
    <div class="tabs clearfix">
      <div class="tabsLeft">
        <ul>
          <li><a href="#" class="active">Article</a></li>
          <li><a target="_github" href="https://github.com/smallbasic/smallbasic.github.io/issues">Talk</a></li>
        </ul>
      </div>
      <div id="simpleSearch">
        <div id="submitSearch"></div>
        <form action="https://github.com/smallbasic/smallbasic.github.io/search"
              target="_github" accept-charset="UTF-8" method="get" style="display:inline">
          <input type="hidden" class="js-site-search-type-field" name="type">
          <input type="hidden" name="utf8" value="✓">
          <input type="hidden" name="l" value="Visual Basic">
          <input type="text" name="q" placeholder="Search" size="12" id="searchInput">
        </form>
      </div>
      <div class="tabsRight">
        <ul>
          <li><a target="_github" href="https://github.com/smallbasic/smallbasic.github.io/blob/master/_build/pages/vade_control.markdown">View source</a></li>
          <li><a target="_github" href="https://github.com/smallbasic/smallbasic.github.io/commits/master/_build/pages/vade_control.markdown">View history</a></li>
        </ul>
      </div>
    </div>
<div class="article">
<h1 id="control-flow">Control Flow</h1>
<blockquote>
<p>Written by Elmar Vogt, Fürth, GERMANY</p>
</blockquote>
<div class="siteSub">
<p><a href="/index.html">Home</a> &gt; <a href="/pages/vade.html">Vade</a></p>
</div>
<p>In this section we’ll describe a number of ways to establish control flow in a SmallBASIC program, ie everything which keeps the program from simply executing line after line of code. It deals with conditional operations loops, and exceptions.</p>
<h2 id="conditionals">Conditionals</h2>
<h3 id="section"></h3>
<p>The most simple case is an construct, which should be familiar from other BASIC dialects.</p>
<p>In its regular form, it looks like this:</p>
<pre><code>if temp&gt;20 then
    print &quot;It&#39;s a warm day.&quot;
endif</code></pre>
<p>The expression following need not be in parentheses. The keyword is optional. The keyword may be replaced with (which is reversed …).</p>
<p>For more complex cases, alternative branches can be explored with the keywords and :</p>
<pre><code>if temp&gt;30 then
    print &quot;It&#39;s really hot.&quot;
elseif temp&gt;20 then
    print &quot;It&#39;s a warm day.&quot;
else
    print &quot;It&#39;s cool.&quot;
endif</code></pre>
<p>can be replaced with . will catch all alternatives, if none of the and branches are true.</p>
<p>Note that all the branches can be tested against arbitrary expressions; they don’t need to refer to the same variable. If you want to test a single value against several possible outcomes, is probably a better option, see .</p>
<p>Several clauses can be nested. It’s your resposibility to make sure than they are properly closed, especially when you’re using many / branches.</p>
<p>If your »deserts are small«,<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> and you don’t have to process much code in your clause, then there is a single-line variation as well:</p>
<pre><code>if temp&gt;30 then ? &quot;Hot&quot; else ? &quot;Moderate&quot;</code></pre>
<p>Note that in this case, is mandatory, while must not be used. You can put several colon-separated commands between and and after , respectively, provided you can fit everything into a single line of code.</p>
<h3 id="section-1"></h3>
<p>As with the single-line option above, there is also an »inline« if clause. »C« users will be reminded of the syntax used there. In , it is the keyword , followed by a list of three parameters. The first is the condition, the second the result of the clause in the case the condition is true, and the third the result otherwise. The following two examples are equivalent:</p>
<pre><code>nuffda= iff(hoogla, boogla, zoogla)

if hoogla
    nuffda= boogla
else
    nuffda= zoogla
endif</code></pre>
<p>helps you to make your code more concise, and better readable. Since is simply a function, it can also show up within more complex expressions:</p>
<pre><code>honka= &quot;Hello, &quot; + iff(its_a_boy, &quot;dude&quot;, &quot;chick&quot;) + &quot;!&quot;</code></pre>
<p>which may or may not help with the readability of your code.</p>
<h3 id="section-2"></h3>
<p>Finally, many programming languages offer a simplified syntax for testing a single variable (or expression) against a number of conditions, and SmallBASIC is no exception.</p>
<p>Here, such a clause is introduced with the two keywords , followed by a variable or expression. Then, a number of conditions will be tested with statements, before the whole clause is closed with :</p>
<pre><code>nuffda= 10

select case nuffda
  case 1
    ? &quot;1&quot;
  case 10
    ? &quot;10&quot;
end select</code></pre>
<p>Each is followed by an expression (variable or function) against which the expression is tested. The expression is evaluated only once, namely when entering the whole construct.</p>
<p>Note that, compared to other programming languages, there are several limitations to the construct:</p>
<ul>
<li><p>No required or even allowed. This makes it impossible to achieve a »fallthrough« of several clauses (intentionally or accidentally).</p></li>
<li><p>There is no way to compare for inequality (like – this would be an illegal construct), and</p></li>
<li><p>There is no clause which would serve to catch the cases not dealt with explicitly (analogous to the clause in constructs).</p></li>
</ul>
<h2 id="loops">Loops</h2>
<h3 id="section-3"></h3>
<p>loops come in two flavours with :</p>
<p>The first is the regular loop which you are probably familiar with from other programming languages:</p>
<pre><code>for i=start to end [step inc]
    ...
next</code></pre>
<p>The keyword and the subsequent increment (which can be any expression, not necessarily only a variable) are optional; if they’re missing, the increment is set to $1$. There is no need to add to the keyword the name of the loop variable.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<p>The index loop variable will be set to the initial value , and the code inside the loop executed at least once. Upon reaching the corresponding statement, the index is compared to the limit given after the keyword. If the index is smaller or equal to , the index is incremented by the , if this is provided, or by $1$), and the loop is traversed once more. (If is negative, the situation is obviously reversed.)</p>
<p>This means that to traverse through a complete array (assuming it uses sequential indices only), you must configure your loop like this:</p>
<pre><code>dim x(423)
...
for i=0 to 423
    ...
next</code></pre>
<p>The index is considered a regular variable inside the loop, and open to manipulation. This means that you can play tricks like:</p>
<pre><code>for i=0 to 100000
    ...
    if i=10
        i= 1000001
    endif
next</code></pre>
<p>Since the expression is evaluated after each loop traverse, you can mess with that as well.</p>
<p>The second »flavour« of is meant to deal with more complex arrays and maps. It has a slightly different syntax:</p>
<pre><code>for i in z
    ...
next</code></pre>
<p>where is an array or map. The loop will be traversed once for each member of the structure’s top dimension (as evaluated by , see ). The value of is set to:</p>
<ul>
<li><p>, if is an array, or</p></li>
<li><p>the »next« key of , if it is a map.</p></li>
</ul>
<p>In the case of a map, the map element can be accessed with .<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<pre><code>dim zoogla(5)
zoogla(3)= &quot;uffda&quot;

boogla= [[4, 5, 6, 7], 2390023, [3.1415926, &quot;hoogla!&quot;], 99]
boogla(&quot;tchaka&quot;)= 500
boogla.bonka= 999

for x in zoogla
  ? x
next
?
for x in boogla
  ? x, boogla(x)
next 

&gt; 0
&gt; 0
&gt; 0
&gt; uffda
&gt; 0
&gt; 0
&gt;
&gt; 0 [4,5,6,7]
&gt; 1 2390023
&gt; 2 [3.1415926,hoogla!]
&gt; 3 99
&gt; BONKA 999
&gt; tchaka    500</code></pre>
<p>Since it’s only determined at runtime which keys are used to point to map members, this method is necessary to make it possible to traverse through all map members in a loop.</p>
<p>For maps, there is no defined order in which the keys will be allotted to the index variable.</p>
<h3 id="and">and</h3>
<p>When the number of times a loop is supposed to be executed is not known beforehand (for example, when reading lines from a file when the file length is unknown), SmallBASIC offers two different loop constructs:</p>
<pre><code>while (expression)
    ...
wend

repeat
    ...
until (expression)</code></pre>
<p>In both cases the code block between the loop delimiters will be repeated until an expression will be fulfilled. Note two important differences though:</p>
<ul>
<li><p>In a loop, the loop is executed as long as the expression is <em>true</em> (ie, unequal to $0$), whereas a loop is executed as long as the expression is <em>false</em>, or $0$.</p></li>
<li><p>In a loop, the test for the expression is performed at the <em>beginning</em> of the loop, but in a loop, the expression test takes place at the <em>end</em> of the loop. This has the consequence that the code block is guaranteed to be executed at least once, wheres the code block is not.</p></li>
</ul>
<p>can be any valid term which will result in a value returned, like a variable or a function call. It can even be useful to employ a constant here, namely when you want to break from the loop somewhere in the middle of the code block. For example –</p>
<pre><code>while 1
    &#39; read user input
    ...
    if user_name=correct
        ? &quot;Name &quot;, user_name, &quot; is correct.&quot;
        exit
    endif
    ? &quot;Illegal input&quot;
wend</code></pre>
<p>In this case your loop should contain an statement (see below) to break out of the loop.</p>
<p>This also serves to emulate a construct that would allow for a loop to be executed »indefinitely« which SmallBASIC doesn’t feature genuinely.</p>
<h4 id="pathological-cases">Pathological Cases</h4>
<p>It’s syntactically legal to omit the expressions for or completely. In this case the »expression« is always taken to evaluate to .</p>
<p>With a loop this doesn’t really make sense; the code inside the loop will simply never be executed. In a loop though the situation is different: This loop will endlessly be executed, and in effect such a construct without an expression for will be equivalent to constructs of other languages.</p>
<p>If you employ such a scheme, make sure that you provide a way to leave the loop, like for example an statement:</p>
<h3 id="section-4"></h3>
<p>The keyword lets you exit immediately from the innermost loop it is found in. (This is equivalent to the »C« statement .) You can specify a qualifier with , namely one of , , , or , which will make SmallBASIC leave the innermost surrounding structure of that type. ( includes and constructs.)</p>
<h2 id="exceptions">Exceptions:</h2>
<p>Exceptions provide a fairly comfortable way to catch runtime errors occuring unexpectedly in your program. Of course, they can’t help with faulty program logic. Rather, exceptions are supposed to handle files not conforming to an expected format, hardware problems and the like.</p>
<p>Formally, an exception block somewhat resembles a sequence. It consists of an outer »bracket« of and keywords, which delimites the »regime« of code to which the exception handling applies.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> Inside this bracket there are one or more sections, each of which applies to one particular error condition:</p>
<pre><code>try
    &#39; error-generating section
    ...
    catch error1
        &#39; dealing with the first error case
        ...
    catch error2
        &#39; ... second error case
        ...
    &#39; and so on
end try</code></pre>
<p>You have basically two options to catch errors this way:</p>
<p>Firstly, as shown above, you may provide <em>several</em> -phrases.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> In this case, , and so on must be string expressions. Once an error is raised, these string expressions are compared to the error message associated with the error, and the first section which matches the error message will be executed,<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> whereupon the section will be left and the »regular« surrounding code will be resumed. If none of the expressions matches, program execution is resumed after , too.</p>
<p>Your second option is to provide only a <em>single</em> . In this case, must be a simple string variable, and the current error string will be assigned to this variable (provided any error occured at all). The corresponding section will then be executed, regardless of the exact nature of the error.</p>
<p>The second option is thus preferrable if you either want to have a simple »catch all« which will deal with any imaginable error in a single sweep, or, at the other extreme, if the error conditions you expect to encounter are so confusing that you’d rather dedicate some more sophisticated code to them than simple string comparisons against the error messages.</p>
<p>If no error is caused in the error-generating section, then none of the sections are executed. Errors raised outside the section can’t be evaluated inside it. (The will have caused your program to halt already.)</p>
<p>If no error occured, but you feel facetious, you can use <strong>to create any desired error</strong>. The syntax is simply –</p>
<pre><code>throw my_err</code></pre>
<p>with the parameter being the error string. (Outside of a block, will cause the program to abort.)</p>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p><em>He either fears his fate too much<br />
Or his deserts are small<br />
Who dares not put it to the touch<br />
To win, or lose, it all</em> – Earl of Montrose<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Currently, you can write <em>anything</em> you want there without causing an error, but I guess this is more a bug than a feature, and will be removed over the next few versions.<a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>Yes, that’s correct. Read it again.<a href="#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>Obviously, in different sections of your code you may want to respond to the same error in different ways, thus there’s no »global« treatment.<a href="#fnref4" class="footnote-back">↩</a></p></li>
<li id="fn5"><p>if you’ll pardon the pun<a href="#fnref5" class="footnote-back">↩</a></p></li>
<li id="fn6"><p>Which means that, to use the exception mechanism responsibly, you must have a good idea what the error messages you may encounter will look like.<a href="#fnref6" class="footnote-back">↩</a></p></li>
</ol>
</section>
</div>
    <div class="pagefooter">
      This page was last edited on Sat, 24 Mar 2018 08:08:27 +1000
 | Markdown processed with
      <a href="https://pandoc.org/MANUAL.html#pandocs-markdown" target="_new" rel="nofollow">pandoc 2.1.2</a>
      | Template by <a href="http://html5-templates.com/" target="_new" rel="nofollow">HTML5 Templates</a>
    </div>
  </div>
</div>
  </body>
</html>
